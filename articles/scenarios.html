<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="dcmodifydb">
<title>Correction scenarios • dcmodifydb</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Correction scenarios">
<meta property="og:description" content="dcmodifydb">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dcmodifydb</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0.9001</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/dcmodifydb.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/scenarios.html">Correction scenarios</a>
    <a class="dropdown-item" href="../articles/syntax.html">Modification syntax</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/data-cleaning/dcmodifydb/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="scenarios_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Correction scenarios</h1>
            <h3 data-toc-skip class="subtitle">Common errors and their corrections</h3>
            
      
      <small class="dont-index">Source: <a href="https://github.com/data-cleaning/dcmodifydb/blob/HEAD/vignettes/scenarios.Rmd" class="external-link"><code>vignettes/scenarios.Rmd</code></a></small>
      <div class="d-none name"><code>scenarios.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The goal of <code>dcmodifydb</code> is to apply modification rules specified with <code>dcmodify</code> on a database table, allowing for documented, reproducable data cleaning adjustments in a database.</p>
<p>This document provides examples and common error corrections scenario’s for which <code>dcmodify</code> can be used.</p>
</div>
<div class="section level2">
<h2 id="document-rules">Document rules<a class="anchor" aria-label="anchor" href="#document-rules"></a>
</h2>
<p>A good practice is to store the intent and description of each rule: this enables future (co)workers on the dataset to evaluate the use of each rule. It is therefore recommended to store rules in a <code>yaml</code> format and document each rule accordingly.</p>
</div>
<div class="section level2">
<h2 id="error-scenarios">Error scenario’s<a class="anchor" aria-label="anchor" href="#error-scenarios"></a>
</h2>
<div class="section level4">
<h4 id="replacing-common-mistakes">Replacing common mistakes<a class="anchor" aria-label="anchor" href="#replacing-common-mistakes"></a>
</h4>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dcmodify/man/modifier.html" class="external-link">modifier</a></span><span class="op">(</span> <span class="kw">if</span> <span class="op">(</span><span class="va">year</span> <span class="op">&lt;</span> <span class="fl">25</span><span class="op">)</span> <span class="va">year</span> <span class="op">=</span> <span class="va">year</span> <span class="op">+</span> <span class="fl">2000</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dcmodify/man/modifier.html" class="external-link">modifier</a></span><span class="op">(</span> <span class="kw">if</span> <span class="op">(</span><span class="va">year</span> <span class="op">&lt;</span> <span class="fl">100</span><span class="op">)</span><span class="op">{</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">year</span> <span class="op">&gt;</span> <span class="fl">25</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">year</span> <span class="op">=</span> <span class="va">year</span> <span class="op">+</span> <span class="fl">1900</span>
  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
    <span class="va">year</span> <span class="op">=</span> <span class="va">year</span> <span class="op">+</span> <span class="fl">2000</span>
  <span class="op">}</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="replacing-missing-values">Replacing missing values<a class="anchor" aria-label="anchor" href="#replacing-missing-values"></a>
</h4>
<p>A value is not measured (<code>NA</code>), but can be deduced to be of a certain value, e.g. zero. Suppose a health questionair contains questions if a person smokes and if so how many cigarretes per day. Typically if the answer to the first question is “no”, the second question is not asked an thus “unmeasured”, but can be deduced to be 0.</p>
<table class="table">
<thead><tr class="header">
<th align="left">smokes</th>
<th align="right">cigarettes</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">TRUE</td>
<td align="right">10</td>
</tr>
<tr class="even">
<td align="left">FALSE</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="va">smokes</span> <span class="op">==</span>  <span class="cn">FALSE</span><span class="op">)</span> <span class="va">cigarretes</span> <span class="op">=</span> <span class="fl">0</span></code></pre></div>
<pre><code><span class="co">#&gt; Warning in `[&lt;-.data.frame`(`*tmp*`, I, , value = structure(list(smokes =</span>
<span class="co">#&gt; FALSE, : provided 3 variables to replace 2 variables</span></code></pre>
<table class="table">
<thead><tr class="header">
<th align="left">smokes</th>
<th align="right">cigarettes</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">TRUE</td>
<td align="right">10</td>
</tr>
<tr class="even">
<td align="left">FALSE</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="recoding">Recoding<a class="anchor" aria-label="anchor" href="#recoding"></a>
</h4>
</div>
</div>
<div class="section level2">
<h2 id="sql-translation">SQL translation<a class="anchor" aria-label="anchor" href="#sql-translation"></a>
</h2>
</div>
<div class="section level2">
<h2 id="syntax">Syntax<a class="anchor" aria-label="anchor" href="#syntax"></a>
</h2>
<div class="section level3">
<h3 id="if-rule">
<code>if</code> rule<a class="anchor" aria-label="anchor" href="#if-rule"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dcmodify/man/modifier.html" class="external-link">modifier</a></span><span class="op">(</span> <span class="kw">if</span> <span class="op">(</span><span class="va">age</span> <span class="op">&lt;</span> <span class="fl">12</span><span class="op">)</span> <span class="va">income</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<p>The following statements are equivalent. It is wise to choose a syntax that is familiar to the persons specifying the correction rules.</p>
<pre eval="FALSE"><code><span class="kw">if</span> <span class="op">(</span><span class="va">age</span> <span class="op">&lt;</span> <span class="fl">12</span><span class="op">)</span> <span class="va">income</span> <span class="op">=</span> <span class="fl">0</span>  <span class="co"># R noobs</span>
<span class="kw">if</span> <span class="op">(</span><span class="va">age</span> <span class="op">&lt;</span> <span class="fl">12</span><span class="op">)</span> <span class="va">income</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co"># a bit more R-y</span>
<span class="va">income</span><span class="op">[</span><span class="va">age</span> <span class="op">&lt;</span> <span class="fl">12</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span>     <span class="co"># very R-y</span></code></pre>
<div class="section level4">
<h4 id="else">
<code>else</code><a class="anchor" aria-label="anchor" href="#else"></a>
</h4>
<p>Each <code>if</code> rule may be followed with an <code>else</code> or <code>else if</code></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dcmodify/man/modifier.html" class="external-link">modifier</a></span><span class="op">(</span><span class="kw">if</span> <span class="op">(</span><span class="va">age</span> <span class="op">&gt;</span> <span class="fl">67</span><span class="op">)</span> <span class="op">{</span><span class="va">retired</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="va">retired</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">}</span><span class="op">)</span></code></pre></div>
<p>The following statements are equivalent. It is wise to choose a syntax that is familiar to the persons specifying the correction rules.</p>
<pre eval="FALSE"><code><span class="kw">if</span> <span class="op">(</span><span class="va">age</span> <span class="op">&gt;</span> <span class="fl">67</span><span class="op">)</span> <span class="op">{</span><span class="va">retired</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="va">retired</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">}</span> <span class="co"># R noobs</span>
<span class="kw">if</span> <span class="op">(</span><span class="va">age</span> <span class="op">&gt;</span> <span class="fl">67</span><span class="op">)</span> <span class="op">{</span><span class="va">retired</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="va">retired</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span><span class="op">}</span> <span class="co"># R-y</span>
<span class="va">retired</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="va">age</span> <span class="op">&gt;</span> <span class="fl">67</span><span class="op">)</span> <span class="cn">TRUE</span> <span class="kw">else</span> <span class="cn">FALSE</span> <span class="co"># very R-y</span>
<span class="va">retired</span> <span class="op">&lt;-</span> <span class="va">age</span> <span class="op">&gt;</span> <span class="fl">67</span> <span class="co"># very R-y</span></code></pre>
</div>
<div class="section level4">
<h4 id="multiple-assignments">multiple assignments<a class="anchor" aria-label="anchor" href="#multiple-assignments"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dcmodify/man/modifier.html" class="external-link">modifier</a></span><span class="op">(</span> 
  <span class="kw">if</span> <span class="op">(</span><span class="va">age</span> <span class="op">&gt;</span> <span class="fl">67</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">retired</span> <span class="op">=</span> <span class="cn">TRUE</span>
    <span class="va">salary</span> <span class="op">=</span> <span class="fl">0</span> 
  <span class="op">}</span>
<span class="op">)</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="else-if">
<code>else if</code><a class="anchor" aria-label="anchor" href="#else-if"></a>
</h4>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Edwin de Jonge.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
